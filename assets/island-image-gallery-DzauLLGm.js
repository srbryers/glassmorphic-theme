var u=Object.defineProperty;var I=(o,r,t)=>r in o?u(o,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[r]=t;var a=(o,r,t)=>I(o,typeof r!="symbol"?r+"":r,t);class p extends HTMLElement{constructor(){super(...arguments);a(this,"mainImage",null);a(this,"thumbnails",null);a(this,"prevButton",null);a(this,"nextButton",null);a(this,"images",[]);a(this,"currentIndex",0);a(this,"touchStartX",0);a(this,"touchEndX",0)}connectedCallback(){console.log("[Island] image-gallery hydrated (client:visible)"),this.mainImage=this.querySelector("[data-main-image]"),this.thumbnails=this.querySelectorAll("[data-thumbnail]"),this.prevButton=this.querySelector("[data-prev]"),this.nextButton=this.querySelector("[data-next]"),this.loadImages(),this.setupEventListeners(),this.updateUI(),this.setAttribute("data-hydrated","true")}loadImages(){var s;(s=this.thumbnails)==null||s.forEach((h,c)=>{const n=h.querySelector("img");n&&this.images.push({src:h.dataset.fullSrc||n.src,alt:n.alt,thumbnail:n.src})});const t=new URLSearchParams(window.location.search),e=parseInt(t.get("image")||"0");e>=0&&e<this.images.length&&(this.currentIndex=e)}setupEventListeners(){var t,e,s,h,c,n,l,g;(t=this.thumbnails)==null||t.forEach((i,m)=>{i.addEventListener("click",()=>{this.goTo(m)}),i.addEventListener("keydown",d=>{(d.key==="Enter"||d.key===" ")&&(d.preventDefault(),this.goTo(m))})}),(e=this.prevButton)==null||e.addEventListener("click",()=>this.prev()),(s=this.nextButton)==null||s.addEventListener("click",()=>this.next()),(c=(h=this.mainImage)==null?void 0:h.parentElement)==null||c.addEventListener("touchstart",i=>{this.touchStartX=i.touches[0].clientX},{passive:!0}),(l=(n=this.mainImage)==null?void 0:n.parentElement)==null||l.addEventListener("touchend",i=>{this.touchEndX=i.changedTouches[0].clientX,this.handleSwipe()},{passive:!0}),this.addEventListener("keydown",i=>{i.key==="ArrowLeft"?this.prev():i.key==="ArrowRight"&&this.next()}),document.addEventListener("variant:image-change",(i=>{this.handleVariantChange(i.detail)})),document.addEventListener("lightbox:change",(i=>{i.detail.index!==void 0&&this.goTo(i.detail.index)})),(g=this.mainImage)==null||g.addEventListener("click",()=>{this.openZoom()})}handleSwipe(){const e=this.touchStartX-this.touchEndX;Math.abs(e)>50&&(e>0?this.next():this.prev())}handleVariantChange(t){const e=this.images.findIndex(s=>s.src===t.src);e>=0?this.goTo(e):this.mainImage&&(this.mainImage.src=t.src,this.mainImage.alt=t.alt)}goTo(t){t<0||t>=this.images.length||t!==this.currentIndex&&(this.currentIndex=t,this.updateUI(),this.dispatchEvent(new CustomEvent("gallery:change",{bubbles:!0,detail:{index:t,image:this.images[t]}})))}prev(){const t=this.currentIndex>0?this.currentIndex-1:this.images.length-1;this.goTo(t)}next(){const t=this.currentIndex<this.images.length-1?this.currentIndex+1:0;this.goTo(t)}updateUI(){var e,s,h;const t=this.images[this.currentIndex];t&&(this.mainImage&&(this.mainImage.classList.add("opacity-0"),setTimeout(()=>{this.mainImage&&(this.mainImage.src=t.src,this.mainImage.alt=t.alt,this.mainImage.classList.remove("opacity-0"))},150)),(e=this.thumbnails)==null||e.forEach((c,n)=>{const l=n===this.currentIndex;c.classList.toggle("ring-2",l),c.classList.toggle("ring-[var(--primary)]",l),c.setAttribute("aria-selected",l.toString())}),(s=this.prevButton)==null||s.classList.toggle("opacity-50",this.currentIndex===0),(h=this.nextButton)==null||h.classList.toggle("opacity-50",this.currentIndex===this.images.length-1))}openZoom(){this.images.length!==0&&document.dispatchEvent(new CustomEvent("modal:open",{detail:{id:"image-zoom",images:this.images,currentIndex:this.currentIndex}}))}}customElements.define("image-gallery",p);
