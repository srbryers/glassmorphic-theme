var c=Object.defineProperty;var u=(h,n,t)=>n in h?c(h,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):h[n]=t;var i=(h,n,t)=>u(h,typeof n!="symbol"?n+"":n,t);class g extends HTMLElement{constructor(){super(...arguments);i(this,"lightbox",null);i(this,"overlay",null);i(this,"image",null);i(this,"prevButton",null);i(this,"nextButton",null);i(this,"closeButton",null);i(this,"currentSpan",null);i(this,"totalSpan",null);i(this,"images",[]);i(this,"currentIndex",0);i(this,"isOpen",!1);i(this,"touchStartX",0);i(this,"touchEndX",0)}connectedCallback(){console.log("[Island] lightbox hydrated (client:idle)"),this.lightbox=this.querySelector("[data-lightbox]"),this.overlay=this.querySelector("[data-lightbox-overlay]"),this.image=this.querySelector("[data-lightbox-image]"),this.prevButton=this.querySelector("[data-lightbox-prev]"),this.nextButton=this.querySelector("[data-lightbox-next]"),this.closeButton=this.querySelector("[data-lightbox-close]"),this.currentSpan=this.querySelector("[data-lightbox-current]"),this.totalSpan=this.querySelector("[data-lightbox-total]"),this.setupEventListeners(),this.setAttribute("data-hydrated","true")}setupEventListeners(){var e,a,r,o,d,l;document.addEventListener("modal:open",(s=>{s.detail.id==="image-zoom"&&this.open(s.detail)})),(e=this.closeButton)==null||e.addEventListener("click",()=>this.close()),(a=this.overlay)==null||a.addEventListener("click",()=>this.close()),(r=this.prevButton)==null||r.addEventListener("click",()=>this.prev()),(o=this.nextButton)==null||o.addEventListener("click",()=>this.next()),document.addEventListener("keydown",s=>{if(this.isOpen)switch(s.key){case"Escape":this.close();break;case"ArrowLeft":this.prev();break;case"ArrowRight":this.next();break}});const t=(d=this.image)==null?void 0:d.parentElement;t==null||t.addEventListener("touchstart",s=>{this.touchStartX=s.touches[0].clientX},{passive:!0}),t==null||t.addEventListener("touchend",s=>{this.touchEndX=s.changedTouches[0].clientX,this.handleSwipe()},{passive:!0}),(l=this.image)==null||l.addEventListener("load",()=>{var s;(s=this.image)==null||s.classList.add("loaded")})}handleSwipe(){const e=this.touchStartX-this.touchEndX;Math.abs(e)>50&&(e>0?this.next():this.prev())}open(t){var e;this.images=t.images||[],this.currentIndex=t.currentIndex||0,this.images.length!==0&&(this.isOpen=!0,this.updateImage(),this.updateUI(),(e=this.lightbox)==null||e.setAttribute("aria-hidden","false"),document.body.style.overflow="hidden",setTimeout(()=>{var a;(a=this.closeButton)==null||a.focus()},100))}close(){var t,e;this.isOpen=!1,(t=this.lightbox)==null||t.setAttribute("aria-hidden","true"),document.body.style.overflow="",(e=this.image)==null||e.classList.remove("loaded"),document.dispatchEvent(new CustomEvent("modal:close",{detail:{id:"image-zoom"}}))}prev(){this.currentIndex>0&&(this.currentIndex--,this.updateImage(),this.updateUI(),this.dispatchChangeEvent())}next(){this.currentIndex<this.images.length-1&&(this.currentIndex++,this.updateImage(),this.updateUI(),this.dispatchChangeEvent())}updateImage(){const t=this.images[this.currentIndex];if(!t||!this.image)return;this.image.classList.remove("loaded");const e=this.getHighResSrc(t.src);this.image.src=e,this.image.alt=t.alt}getHighResSrc(t){if(t.includes("cdn.shopify.com")){const e=new URL(t);return e.searchParams.set("width","1600"),e.toString()}return t}updateUI(){this.currentSpan&&(this.currentSpan.textContent=String(this.currentIndex+1)),this.totalSpan&&(this.totalSpan.textContent=String(this.images.length)),this.prevButton&&(this.prevButton.disabled=this.currentIndex===0),this.nextButton&&(this.nextButton.disabled=this.currentIndex===this.images.length-1)}dispatchChangeEvent(){document.dispatchEvent(new CustomEvent("lightbox:change",{detail:{index:this.currentIndex,image:this.images[this.currentIndex]}}))}}customElements.define("lightbox-island",g);
