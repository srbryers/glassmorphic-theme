{%- comment -%}
  Customer Account Section
  Renders account dashboard with order history.
{%- endcomment -%}

<div class="customer-account py-12 md:py-20">
  <div class="container max-w-4xl mx-auto px-4">
    <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-8">
      <div>
        <h1 class="font-heading text-3xl md:text-4xl font-bold">
          {{ 'customer.account.title' | t }}
        </h1>
        <p class="text-[var(--muted-foreground)] mt-1">
          {{ 'customer.account.welcome' | t: name: customer.first_name }}
        </p>
      </div>
      <a href="{{ routes.account_logout_url }}" class="btn btn-outline self-start">
        {{ 'customer.account.logout' | t }}
      </a>
    </div>

    <div class="grid md:grid-cols-3 gap-6 mb-12">
      <a href="{{ routes.account_addresses_url }}" class="glass rounded-xl p-6 hover:shadow-glass-lg transition-shadow group">
        <div class="flex items-center gap-4">
          <div class="w-12 h-12 rounded-full bg-[var(--primary)]/10 flex items-center justify-center text-[var(--primary)]">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"/>
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"/>
            </svg>
          </div>
          <div>
            <h3 class="font-medium group-hover:text-[var(--primary)] transition-colors">
              {{ 'customer.account.addresses' | t }}
            </h3>
            <p class="text-sm text-[var(--muted-foreground)]">
              {{ customer.addresses_count }} {{ 'customer.account.saved' | t }}
            </p>
          </div>
        </div>
      </a>

      <div class="glass rounded-xl p-6">
        <div class="flex items-center gap-4">
          <div class="w-12 h-12 rounded-full bg-[var(--primary)]/10 flex items-center justify-center text-[var(--primary)]">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"/>
            </svg>
          </div>
          <div>
            <h3 class="font-medium">{{ 'customer.account.orders' | t }}</h3>
            <p class="text-sm text-[var(--muted-foreground)]">
              {{ customer.orders_count }} {{ 'customer.account.total_orders' | t }}
            </p>
          </div>
        </div>
      </div>

      <div class="glass rounded-xl p-6">
        <div class="flex items-center gap-4">
          <div class="w-12 h-12 rounded-full bg-[var(--primary)]/10 flex items-center justify-center text-[var(--primary)]">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/>
            </svg>
          </div>
          <div>
            <h3 class="font-medium">{{ 'customer.account.email' | t }}</h3>
            <p class="text-sm text-[var(--muted-foreground)] truncate max-w-[180px]">
              {{ customer.email }}
            </p>
          </div>
        </div>
      </div>
    </div>

    <div class="glass rounded-2xl overflow-hidden">
      <div class="p-6 border-b border-[var(--border)]">
        <h2 class="font-heading text-xl font-bold">{{ 'customer.account.order_history' | t }}</h2>
      </div>

      {%- if customer.orders.size > 0 -%}
        <div class="overflow-x-auto">
          <table class="w-full">
            <thead class="bg-[var(--muted)]/50">
              <tr>
                <th class="px-6 py-3 text-left text-xs font-medium text-[var(--muted-foreground)] uppercase tracking-wider">
                  {{ 'customer.orders.order_number' | t }}
                </th>
                <th class="px-6 py-3 text-left text-xs font-medium text-[var(--muted-foreground)] uppercase tracking-wider">
                  {{ 'customer.orders.date' | t }}
                </th>
                <th class="px-6 py-3 text-left text-xs font-medium text-[var(--muted-foreground)] uppercase tracking-wider">
                  {{ 'customer.orders.payment_status' | t }}
                </th>
                <th class="px-6 py-3 text-left text-xs font-medium text-[var(--muted-foreground)] uppercase tracking-wider">
                  {{ 'customer.orders.fulfillment_status' | t }}
                </th>
                <th class="px-6 py-3 text-right text-xs font-medium text-[var(--muted-foreground)] uppercase tracking-wider">
                  {{ 'customer.orders.total' | t }}
                </th>
              </tr>
            </thead>
            <tbody class="divide-y divide-[var(--border)]">
              {%- for order in customer.orders -%}
                <tr class="hover:bg-[var(--muted)]/30 transition-colors">
                  <td class="px-6 py-4 whitespace-nowrap">
                    <a href="{{ order.customer_url }}" class="text-[var(--primary)] hover:underline font-medium">
                      {{ order.name }}
                    </a>
                  </td>
                  <td class="px-6 py-4 whitespace-nowrap text-sm">
                    {{ order.created_at | date: format: 'abbreviated_date' }}
                  </td>
                  <td class="px-6 py-4 whitespace-nowrap">
                    <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium
                      {%- if order.financial_status == 'paid' %} bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400
                      {%- elsif order.financial_status == 'pending' %} bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400
                      {%- else %} bg-gray-100 text-gray-800 dark:bg-gray-900/30 dark:text-gray-400
                      {%- endif -%}">
                      {{ order.financial_status_label }}
                    </span>
                  </td>
                  <td class="px-6 py-4 whitespace-nowrap">
                    <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium
                      {%- if order.fulfillment_status == 'fulfilled' %} bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400
                      {%- elsif order.fulfillment_status == 'partial' %} bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400
                      {%- else %} bg-gray-100 text-gray-800 dark:bg-gray-900/30 dark:text-gray-400
                      {%- endif -%}">
                      {{ order.fulfillment_status_label | default: 'Unfulfilled' }}
                    </span>
                  </td>
                  <td class="px-6 py-4 whitespace-nowrap text-sm text-right font-medium">
                    {{ order.total_price | money }}
                  </td>
                </tr>
              {%- endfor -%}
            </tbody>
          </table>
        </div>

        {%- if customer.orders.size > 20 -%}
          <div class="p-6 border-t border-[var(--border)]">
            {% paginate customer.orders by 20 %}
              {{ paginate | default_pagination }}
            {% endpaginate %}
          </div>
        {%- endif -%}
      {%- else -%}
        <div class="p-12 text-center">
          <div class="w-16 h-16 rounded-full bg-[var(--muted)] flex items-center justify-center mx-auto mb-4">
            <svg class="w-8 h-8 text-[var(--muted-foreground)]" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"/>
            </svg>
          </div>
          <h3 class="font-medium mb-2">{{ 'customer.orders.empty_title' | t }}</h3>
          <p class="text-[var(--muted-foreground)] mb-6">{{ 'customer.orders.empty_description' | t }}</p>
          <a href="{{ routes.all_products_collection_url }}" class="btn btn-primary">
            {{ 'customer.orders.start_shopping' | t }}
          </a>
        </div>
      {%- endif -%}
    </div>
  </div>
</div>

{% schema %}
{
  "name": "Customer Account",
  "tag": "section",
  "class": "section-customer-account",
  "settings": []
}
{% endschema %}
